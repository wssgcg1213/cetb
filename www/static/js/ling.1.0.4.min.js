var api={basic:"/api/v2/basic",config:"/api/v2/config",noTicket:"/api/v2/noticket"};var store=function(e){function t(){}if("object"!==typeof e){return{set:t,get:t,getAll:t,remove:t,clear:t}}var n=function(t,n){if(undefined==n){i(t)}else{e.setItem(t,JSON.stringify(n))}};var r=function(t){var n=e.getItem(t);if("string"!==typeof n){return undefined}try{return JSON.parse(n)}catch(r){return n||undefined}};var a=function(){var t={},n;for(var a=0;a<e.length;a++){n=e.key(a);t[n]=r(n)}return t};var i=function(t){return e.removeItem(t)};var o=function(){return e.clear()};return{set:n,get:r,getAll:a,remove:i,clear:o}}(window.localStorage);!function(){var e=new Swiper(".tabs-container",{speed:500,onSlideChangeStart:function(){$(".tabs .active").removeClass("active");$(".tabs li").eq(e.activeIndex).addClass("active");$(".footer").css("top",$(".swiper-slide-active").height()+"px")}});$(".tabs").on("touchstart mousedown","li",function(t){t.preventDefault();$(".tabs .active").removeClass("active");$(this).addClass("active");e.slideTo($(this).index())});$("input, select").on("touchstart touchend touchmove mousemove",function(e){e.stopPropagation()});$("button").on("click",false)}();!function(e,t){var n=e(".container");var r=e(".loading-cover");function a(){n.removeClass("loading");r.css("display","none")}function i(e,t){var n=new Array(256);var r=new Array(e.length);var a,i="",o,s,c;for(a=0;a<256;a++){n[a]=a;i=(i+n[a]+t.charCodeAt(a%t.length))%256;s=n[a];n[a]=n[i];n[i]=s}for(a=0;a<e.length;a++){r[a]=e.charCodeAt(a)}for(o=0;o<r.length;o++){a=(a+1)%256;i=(i+n[a])%256;s=n[a];n[a]=n[i];n[i]=s;c=(n[a]+n[i]%256)%256;r[o]=String.fromCharCode(r[o]^n[c])}return r.join("")}var o=345783475897349,s=0xd50877bb9bb4,c=673442364363456;function u(e){try{if(!window.__config["data"]["date"]){return c}}catch(t){return c}if(e.length!==15){return o}if(e.substr(6,3)!=window.__config["data"]["date"]){return s}return true}function l(e){return!!(e+"").match(/^[\u4e00-\u9fa5]{2,}$/)}var f=new t({el:"#result",data:{name:"",school:"",type:"",tid:"",time:"",all:"",listening:"",reading:"",writing:"",show:false},methods:{back:function(e){location.reload()}}});f.$watch("show",function(t){if(t){e(".tabs-container, .tabs").hide()}else{e(".tabs-container, .tabs").show()}});function d(e){f.name=e.name;f.school=e.school;f.time="20"+e.tid.substr(6,2)+"年"+(e.tid.substr(8,1)==1?"6":"12")+"月";f.type=e.tid.substr(9,1)==1?"英语四级":"英语六级";f.tid=e.tid;f.all=e.all;f.listening=e.listening;f.reading=e.reading;f.writing=e.writing;f.show=true}var g=function(){a();var n=[{text:"请选择省份",value:""}];var r;for(r in window.__config.data.province){n.push({text:r,value:r})}function f(e){if(!e||e.status!=0){alert(e.info);return false}var t=i(e.data.ticket,e.info);var n=JSON.parse(i(e.data.grade,e.info));d({tid:t,name:e.data.name,school:e.data.school,all:n.all,reading:n.reading,writing:n.writing,listening:n.listening})}function g(){alert("网络故障, 请重试")}var v=new t({el:"#query",data:{id:"",username:"",show:true,loading:false},methods:{query:function(t){t.preventDefault();if(v.loading){return}if(!l(v.username)){alert("请输入正确的姓名!");return false}switch(u(v.id)){case c:alert("程序还未加载完成!");return false;case o:alert("请输入正确的准考证号!");return false;case s:alert("现在仅能查询"+window.__config.data.date.substr(0,2)+"年"+(window.__config.data.date.substr(2,1)==1?"6":"12")+"月的成绩");return false}var n={name:this.username,ticket:this.id};e.ajax({url:api.basic,type:"POST",data:n,timeout:3e3,success:f,error:g,beforeSend:function(){v.loading=true},complete:function(){v.loading=false}})}}});var h=new t({el:"#noTicketQuery",data:{username:"",province:"",school:"",type:"",provinces:n,schools:[{text:"请先选择省份",value:""}],loading:false,show:true},methods:{query:function(t){t.preventDefault();if(h.loading){return}if(!l(h.username)){alert("请输入正确的姓名!");return false}if(!h.province){alert("请选择省份!");return false}if(!h.school){alert("请选择学校!");return false}var n={name:this.username,school:this.school,cetType:this.type};e.ajax({url:api.noTicket,type:"POST",data:n,timeout:3e3,success:f,error:g,beforeSend:function(){h.loading=true},complete:function(){h.loading=false}})}}});h.$watch("province",function(e){h["school"]="";var t;try{t=window.__config.data.province[e][1].map(function(e){return{text:e,value:e}})}catch(n){return h["schools"]=[{text:"请先选择省份",value:""}]}h["schools"]=t})};if(store){var v=store.get("cet-config-store");var h=!store.get("cet-config-time")&&+new Date-store.get("cet-config-time")>1e3*3600*24;if(v&&!h){window.__config=v;g();return}}if(!window.__config){window.init=function(){store&&store.set("cet-config-store",window.__config);store&&store.set("cet-config-time",+new Date);g()}}else{store&&store.set("cet-config-store",window.__config);store&&store.set("cet-config-time",+new Date);g()}}(Zepto,Vue);